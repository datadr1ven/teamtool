<!DOCTYPE html>
<html>
<head>
    <title>Simple 2D Animation</title>
    <style>
        #canvas {
            border: 1px solid black;
        }
    </style>
</head>
<body>
  <canvas id="canvas" width="400" height="400"></canvas>
  <script src="track.js"></script>
  <script src="racing_lines.js"></script>
  <script src="colors.js"></script>
  <script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    
    
    const track_len = track.length;
    
    const canvas_width = 400;
    const canvas_height = 400;
    let car_idx = 0;
    const racing_points = racing_lines[Object.keys(driver_colors)[0]].length;
    
    function animate() {
        // Clear the canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);
	
	for(let idx = 0; idx < track_len; idx += 1){
	    
	    const x1 = track[idx%track_len][0];
	    const y1 = (-track[idx%track_len][1])+canvas_height;
	    
	    const x2 = track[(idx+1)%track_len][0];
	    const y2 = (-track[(idx+1)%track_len][1])+canvas_height;
	    
	    ctx.beginPath();
	    ctx.moveTo(x1, y1); 
	    ctx.lineTo(x2, y2); 
	    ctx.strokeStyle = "gray"; 
	    ctx.lineWidth = 3; 
	    ctx.stroke();
	}

	Object.keys(driver_colors).forEach( function(driver) {
	    ctx.beginPath();
	    ctx.strokeStyle = "#" + driver_colors[driver]; 
            ctx.arc(racing_lines[driver][Math.floor(car_idx/20)][0], (-racing_lines[driver][Math.floor(car_idx/20)][1])+canvas_height, 3, 0, 2 * Math.PI);
            ctx.stroke();
	    if (Math.floor(car_idx/20) < racing_points-1){
		car_idx += 1;
	    }
	});
	
        // Request the next frame
        requestAnimationFrame(animate);
    }
    
    // Start the animation
    animate();
  </script>
</body>
</html>

