<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <script src="./topnav.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="./style.css">
  </head>
  <body>
      <canvas id="cw"></canvas>
      <script src="track.js"></script>
      <script src="racing_lines.js"></script>
      <script src="colors.js"></script>
  <script>
    const canvas = document.getElementById('cw');
    const ctx = canvas.getContext('2d');
    
    const track_len = track.length;
 
    ctx.canvas.width  = window.innerWidth;
    ctx.canvas.height = window.innerHeight;

    const multiplier = ctx.canvas.width / 980.0;
    const vert_offset = 1500;
    
    let car_idx = 0;
    const racing_points = racing_lines[Object.keys(driver_colors)[0]].length;
    
    function animate() {
        // Clear the canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);
	for(let idx = 0; idx < track_len; idx += 1){
	    
	    const x1 = track[idx%track_len][0] * multiplier;
	    const y1 = ((-track[idx%track_len][1])+vert_offset) * multiplier;
	    
	    const x2 = track[(idx+1)%track_len][0] * multiplier;
	    const y2 = ((-track[(idx+1)%track_len][1])+vert_offset) * multiplier;
	    
	    ctx.beginPath();
	    ctx.moveTo(x1, y1); 
	    ctx.lineTo(x2, y2); 
	    ctx.strokeStyle = "gray"; 
	    ctx.lineWidth = 8; 
	    ctx.stroke();
	}

	Object.keys(driver_colors).forEach( function(driver) {
	    ctx.beginPath();
	    ctx.strokeStyle = "#" + driver_colors[driver]; 
            ctx.arc(racing_lines[driver][Math.floor(car_idx/20)][0]*multiplier, ((-racing_lines[driver][Math.floor(car_idx/20)][1])+vert_offset)*multiplier, 8, 0, 2 * Math.PI);
            ctx.stroke();
	    if (Math.floor(car_idx/20) < racing_points-1){
		car_idx += 1;
	    }
	});
	
        // Request the next frame
        requestAnimationFrame(animate);
    }
    
    // Start the animation
    animate();
  </script>

    <!-- <canvas id="cw">Simple Grid Animation</canvas> ->
	 <!-- Top Navigation Menu -->
    
    <div class="topnav">
      <a href="javascript:void(0);" class="active">
	<h1>Team Evaluator</h1>
      </a>
      <!-- Navigation links (hidden by default) -->
      <!-- <script src="./grid.js"></script> -->
      <div id="myLinks">
	<a href="javascript:void(0);" onclick="showAbout();">About</a>
	<a href="javascript:void(0);" onclick="showDisclaimer();">Disclaimer</a>
      </div>
      <!-- "Hamburger menu" / "Bar icon" to toggle the navigation links -->
      <a href="javascript:void(0);" class="icon" onclick="myFunction();">
	<i class="fa fa-bars"></i>
      </a>
    </div>
    <div class="content">
      <p>This page currently uses 2024 points/price data, and reflects results through the Mexico City Grand Prix. Pick the window of races for which to calculate points and price, and then adjust team composition to evaluate performance</p>
      <div id="intervalpicker" class="us-form darktest">
	<table>
	  <tr>
	    <td class="unwrap">
	      <label for="last_race">First race:</label>
	      
	      <select name="first_race" id="first_race">
	      </select>
	    </td>
	    <td class="unwrap">
	      <label for="last_race">Last race:</label>
	      
	      <select name="last_race" id="last_race">
	      </select>
	    </td>
	  </tr>
	</table>
      </div>
      <div id="intervalperformance"></div>
      <div id="teampicker" class="us-form darktest">
	<table>
	  <tr>
	    <td class="unwrap">
	      <label for="second_driver"></label>
	      
	      <select name="second_driver" id="second_driver">
	      </select>
	    </td>
	    <td class="unwrap">
	      <label for="third_driver"></label>
	      
	      <select name="third_driver" id="third_driver">
	      </select>
	    </td>
	  </tr>
	  <tr>
	    <td class="unwrap">
	      <label for="fourth_driver"></label>
	      
	      <select name="fourth_driver" id="fourth_driver">
	      </select>
	    </td>
	    <td class="unwrap">
	      <label for="fifth_driver"></label>
	      
	      <select name="fifth_driver" id="fifth_driver">
	      </select>
	    </td>
	  </tr>
	  <tr>
	    <td class="unwrap" colspan="2" style="text-align: center;">
	      <label for="2x_driver">2x:</label>
	      <select name="2x_driver" id="2x_driver">
	      </select>
	    </td>
	  </tr>
	  <tr>
	    <td class="unwrap">
	      <label for="first_team"></label>
	      
	      <select name="first_team" id="first_team">
	      </select>
	    </td>
	    <td class="unwrap">
	      <label for="second_team"></label>
	      
	      <select name="second_team" id="second_team">
	      </select>
	    </td>
	  </tr>
	</table>
      </div>
      <div id="teamperformance"></div>
      <script type="module" src="teamtool.js"></script>
    </div>
  </body>
</html>
